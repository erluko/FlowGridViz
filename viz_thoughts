Like AMON, use buckets. From [Abdullah, Lee, Conti Copeland] use the knowledge of expected port number ranges, but learn from AMON's bucket idea:

X = dest port
Y = src port




tshark -r file -T json -e ip.srcaddr -e ip.dstaddr -e udp.srcport -e udp.srcport -e tcp.srcport -e tcp.dstport -c 10

tshark -r ~/Downloads/ISCX_Botnet-Training.pcap -T json -e ip.src -e ip.dst -e udp.srcport -e udp.srcport -e tcp.srcport -e tcp.dstport -c 100  'tcp or udp'
